<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulaire Véhicules</title>
</head>
<body>
    <h2>Formulaire Véhicules</h2>
    <form onsubmit="event.preventDefault(); enregistrerDonneesLocalement();">
        <label>Véhicule :</label>
        <select id="vehicule">
            <option value="YARIS DW-477-ZW">YARIS DW-477-ZW</option>
            <option value="ZOE électrique FD-023-YB">ZOE électrique FD-023-YB</option>
            <option value="MEGANE DJ-977-KH">MEGANE DJ-977-KH</option>
        </select><br>
        
        <label>Date début :</label>
        <input type="datetime-local" id="date_debut"><br>
        
        <label>Date fin :</label>
        <input type="datetime-local" id="date_fin"><br>
        
        <label>Kilométrage arrivée :</label>
        <input type="number" id="kilometrage"><br>
        
        <label>Nom :</label>
        <input type="text" id="nom"><br>
        
        <label>Nature mission :</label>
        <input type="text" id="nature_mission"><br>
        
        <label>Lieu mission :</label>
        <input type="text" id="lieu_mission"><br>
        
        <label>Signature :</label>
        <textarea id="signature"></textarea><br>
        
        <button type="submit">Valider</button>
    </form>

    <script>
        const FILE_PATH = "json/";
        const FILE_EXTENSION = ".json";

        function enregistrerDonneesLocalement() {
            const formData = {
                vehicule: document.getElementById("vehicule").value,
                date_debut: document.getElementById("date_debut").value,
                date_fin: document.getElementById("date_fin").value,
                kilometrage_arrivee: document.getElementById("kilometrage").value,
                nom: document.getElementById("nom").value,
                nature_mission: document.getElementById("nature_mission").value,
                lieu_mission: document.getElementById("lieu_mission").value,
                signature: document.getElementById("signature").value
            };

            const fileName = `formulaire_${new Date().toISOString().replace(/[-:]/g, "").split(".")[0]}${FILE_EXTENSION}`;
            localStorage.setItem(`${FILE_PATH}${fileName}`, JSON.stringify(formData));
            alert("✅ Formulaire enregistré localement. Il sera envoyé automatiquement par GitHub Actions.");
        }
    </script>
</body>
</html>
